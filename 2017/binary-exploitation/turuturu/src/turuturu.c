// gcc -D_FORTIFY_SOURCE=2 turuturu.c -o turuturu -fstack-protector-all -Wl,-z,relro,-z,now -fPIE -pie
#include<stdio.h>
#include<stdlib.h>
#include<time.h>
#include<unistd.h>
#include<signal.h>

void printFlag(){
  system("cat flag");
  exit(0);
}

int main(){
  alarm(5);
  signal(SIGALRM, exit);
  int i;
  int pin[8];
  char buff[8];
  srand(time(NULL));
  for(i=0;i<8;i++){
    pin[i] = rand() % 10;
  }
  puts("[=== Turuturu ===]");
  for(i=0; i<5; i++){
    puts("Masukkan PIN:");
    fgets(buff, 9, stdin);
    strtok(buff, "\n");
    if((pin[0] == buff[0] - '0') && (pin[1] == buff[1] - '0') && (pin[2] == buff[2] - '0') && (pin[3] == buff[3] - '0') && (pin[4] == buff[4] - '0') && (pin[5] == buff[5] - '0') && (pin[6] == buff[6] - '0') && (pin[7] == buff[7] - '0')){
      printFlag();
    }
    printf("PIN: ");
    printf(buff);
    puts(", tidak sesuai!");
  }

}
